# ESA-KU Website Deployment Guide

This guide will help you deploy your Django website to Render.com for free.

## Prerequisites

1. A GitHub account
2. Your code pushed to a GitHub repository
3. A Render.com account (free)

## Deployment Steps

### 1. Prepare Your Repository

Make sure your code is pushed to GitHub with the following files:
- `render.yaml` - Render deployment configuration
- `requirements.txt` - Python dependencies
- `build.sh` - Build script
- `Procfile` - Process definition

### 2. Deploy to Render.com

1. **Sign up/Login to Render.com**
   - Go to [render.com](https://render.com)
   - Sign up with your GitHub account

2. **Create a New Web Service**
   - Click "New +" → "Web Service"
   - Connect your GitHub repository
   - Select your repository

3. **Configure the Service**
   - **Name**: `esa-website` (or your preferred name)
   - **Environment**: `Python 3`
   - **Build Command**: `./build.sh`
   - **Start Command**: `cd puddle && gunicorn puddle.wsgi:application --bind 0.0.0.0:$PORT`

4. **Add Environment Variables**
   - `SECRET_KEY`: (auto-generated by Render)
   - `DEBUG`: `False`
   - `ALLOWED_HOSTS`: `.onrender.com`
   - `CSRF_TRUSTED_ORIGINS`: `https://*.onrender.com`
   - `SECURE_SSL_REDIRECT`: `True`
   - `SESSION_COOKIE_SECURE`: `True`
   - `CSRF_COOKIE_SECURE`: `True`
   - `EMAIL_BACKEND`: `django.core.mail.backends.console.EmailBackend`
   - `MPESA_ENVIRONMENT`: `sandbox`
   - `PAYPAL_MODE`: `sandbox`

5. **Create Database**
   - Click "New +" → "PostgreSQL"
   - Name: `esa-db`
   - Plan: Free
   - Connect it to your web service

6. **Deploy**
   - Click "Create Web Service"
   - Wait for the build to complete (5-10 minutes)

### 3. Post-Deployment Setup

1. **Access Your Site**
   - Your site will be available at: `https://your-app-name.onrender.com`

2. **Create Admin User**
   - The build script automatically creates an admin user:
   - Username: `admin`
   - Email: `admin@example.com`
   - Password: `admin123`
   - **Important**: Change this password immediately!

3. **Configure Custom Domain (Optional)**
   - In Render dashboard, go to your web service
   - Click "Settings" → "Custom Domains"
   - Add your domain and configure DNS

## Free Tier Limitations

- **Build Time**: 500 minutes/month
- **Runtime**: 750 hours/month (31 days)
- **Database**: 1GB storage
- **Bandwidth**: 100GB/month
- **Sleep Mode**: Services sleep after 15 minutes of inactivity

## Troubleshooting

### Common Issues

1. **Build Fails**
   - Check the build logs in Render dashboard
   - Ensure all dependencies are in `requirements.txt`
   - Verify `build.sh` has execute permissions

2. **Database Connection Issues**
   - Ensure `DATABASE_URL` is properly set
   - Check if database service is running

3. **Static Files Not Loading**
   - Verify `collectstatic` runs successfully
   - Check WhiteNoise configuration in settings

4. **500 Errors**
   - Check application logs in Render dashboard
   - Verify all environment variables are set
   - Check if migrations are applied

### Logs and Debugging

- **Build Logs**: Available in Render dashboard during deployment
- **Application Logs**: Available in Render dashboard under "Logs" tab
- **Database Logs**: Available in database service dashboard

## Alternative Free Deployment Options

### 1. Railway.app
- Similar to Render
- 500 hours/month free
- Automatic deployments from GitHub

### 2. Fly.io
- 3 shared-cpu VMs free
- Global edge deployment
- More complex setup

### 3. Heroku (Limited Free Tier)
- 550-1000 dyno hours/month
- Requires credit card for verification

## Security Considerations

1. **Change Default Admin Password**
2. **Use Strong SECRET_KEY**
3. **Enable HTTPS (automatic on Render)**
4. **Set DEBUG=False in production**
5. **Configure proper ALLOWED_HOSTS**

## Monitoring and Maintenance

1. **Regular Updates**
   - Keep dependencies updated
   - Monitor security advisories

2. **Backup Strategy**
   - Database backups (automatic on Render)
   - Code backups (GitHub)

3. **Performance Monitoring**
   - Monitor response times
   - Check resource usage

## Support

- **Render Documentation**: [docs.render.com](https://docs.render.com)
- **Django Deployment**: [docs.djangoproject.com/en/stable/howto/deployment/](https://docs.djangoproject.com/en/stable/howto/deployment/)
- **Community**: Stack Overflow, Django forums 