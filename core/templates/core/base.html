{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ESA Website</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;500;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <!-- Syntax highlighting for code blocks in markdown -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>

  <!-- Ionicons for icons -->
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

  <!-- Authentication JavaScript -->
  <script src="{% static 'js/auth.js' %}"></script>
 
  <style>
    .custom-logo {
      height: 80px; /* Adjust this value to your desired height */
      width: auto; /* Maintain aspect ratio */
    }
    
    /* Markdown styling */
    .prose {
      max-width: 65ch;
      color: #374151;
    }
    
    .prose h1 {
      font-size: 2.25em;
      margin-top: 0;
      margin-bottom: 0.8888889em;
      line-height: 1.1111111;
      font-weight: 700;
      color: #1e3a8a;
    }
    
    .prose h2 {
      font-size: 1.5em;
      margin-top: 2em;
      margin-bottom: 1em;
      line-height: 1.3333333;
      font-weight: 700;
      color: #1e3a8a;
      border-bottom: 1px solid #e5e7eb;
      padding-bottom: 0.5em;
    }
    
    .prose h3 {
      font-size: 1.25em;
      margin-top: 1.6em;
      margin-bottom: 0.6em;
      line-height: 1.6;
      font-weight: 600;
      color: #1e3a8a;
    }
    
    .prose h4 {
      margin-top: 1.5em;
      margin-bottom: 0.5em;
      line-height: 1.5;
      font-weight: 600;
      color: #1e3a8a;
    }
    
    .prose p {
      margin-top: 1.25em;
      margin-bottom: 1.25em;
      line-height: 1.7;
    }
    
    .prose a {
      color: #1d4ed8;
      text-decoration: underline;
      font-weight: 500;
    }
    
    .prose strong {
      font-weight: 600;
      color: #111827;
    }
    
    .prose ol {
      counter-reset: list-item;
      margin-top: 1.25em;
      margin-bottom: 1.25em;
      padding-left: 1.625em;
    }
    
    .prose ol > li {
      position: relative;
      counter-increment: list-item;
      padding-left: 0.375em;
      margin-bottom: 0.5em;
    }
    
    .prose ul {
      margin-top: 1.25em;
      margin-bottom: 1.25em;
      padding-left: 1.625em;
      list-style-type: disc;
    }
    
    .prose ul > li {
      position: relative;
      padding-left: 0.375em;
      margin-bottom: 0.5em;
    }
    
    .prose blockquote {
      font-weight: 500;
      font-style: italic;
      color: #111827;
      border-left-width: 0.25rem;
      border-left-color: #e5e7eb;
      quotes: "\201C""\201D""\2018""\2019";
      margin-top: 1.6em;
      margin-bottom: 1.6em;
      padding-left: 1em;
    }
    
    .prose code {
      color: #b91c1c;
      font-weight: 600;
      font-size: 0.875em;
      background-color: #f3f4f6;
      padding: 0.25em 0.5em;
      border-radius: 0.375rem;
      font-family: 'Roboto Mono', monospace;
    }
    
    .prose pre {
      color: #e5e7eb;
      background-color: #1f2937;
      overflow-x: auto;
      font-size: 0.875em;
      line-height: 1.7142857;
      margin-top: 1.7142857em;
      margin-bottom: 1.7142857em;
      border-radius: 0.375rem;
      padding: 0.8571429em 1.1428571em;
      font-family: 'Roboto Mono', monospace;
    }
    
    .prose pre code {
      background-color: transparent;
      border-width: 0;
      border-radius: 0;
      padding: 0;
      font-weight: 400;
      color: inherit;
      font-size: inherit;
      font-family: inherit;
      line-height: inherit;
    }
    
    .prose img {
      margin-top: 2em;
      margin-bottom: 2em;
      border-radius: 0.375rem;
      max-width: 100%;
    }
    
    .prose table {
      width: 100%;
      table-layout: auto;
      text-align: left;
      margin-top: 2em;
      margin-bottom: 2em;
      font-size: 0.875em;
      line-height: 1.7142857;
      border-collapse: collapse;
    }
    
    .prose table thead {
      color: #111827;
      font-weight: 600;
      border-bottom-width: 1px;
      border-bottom-color: #d1d5db;
    }
    
    .prose table th {
      padding: 0.5714286em;
      vertical-align: bottom;
    }
    
    .prose table td {
      padding: 0.5714286em;
      vertical-align: top;
      border-top-width: 1px;
      border-top-color: #e5e7eb;
    }
    
    .prose hr {
      border-color: #e5e7eb;
      border-top-width: 1px;
      margin-top: 3em;
      margin-bottom: 3em;
    }
    
    /* Keep only the green focus effect */
    input:focus, textarea:focus, select:focus {
      outline: none;
      --tw-ring-color: #059669;
      --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
      --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
      box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
      
    /* Add subtle animations */
    .animated-input-container {…}

    .animated-input-container:hover {…}

    .animated-button {…}

    .animated-button::after {…}

    @keyframes buttonShine {…}
    
    /* Add your new animation here */
    @keyframes subtlePulse {
      0%, 100% { opacity: 0.2; transform: scale(1); }
      50% { opacity: 0.4; transform: scale(1.02); }
    }

    .pull-system {
      animation: subtlePulse 4s infinite;
    }
  
    /* Add subtle animations */
    .animated-input-container {
      position: relative;
      transition: transform 0.3s ease;
    }

    .animated-input-container:hover {
      transform: translateX(8px);
    }

    .animated-button {
      position: relative;
      overflow: hidden;
    }

    .animated-button::after {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      bottom: -50%;
      left: -50%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transform: rotateZ(60deg) translate(-5em, 7.5em);
      animation: buttonShine 3s infinite;
    }

    @keyframes buttonShine {
      100% { transform: rotateZ(60deg) translate(5em, -7.5em); }
    }

    .animated-checkbox:checked {
      animation: checkboxCheck 0.4s ease;
    }

    @keyframes checkboxCheck {
      50% { transform: scale(1.2); }
    }
  </style>

</head>
<body class="min-h-screen flex flex-col bg-gray-50 text-gray-800">
  <!-- Header -->
  <header>
    <!-- Top Bar -->
    <div class="bg-blue-900 text-white text-sm">
      <div class="container mx-auto px-4 py-2 flex justify-between items-center">
        <div class="space-x-2">
          <a href="{% url 'constitution' %}" class="hover:underline">ESA Constitution</a>
          <span>|</span>
          <a href="{% url 'blog' %}?category=research" class="hover:underline">ESA Publications</a>
          <span>|</span>
          <a href="{% url 'about' %}#leadership-team" class="hover:underline">ESA Excom</a>
          <span>|</span>
          <a href="{% url 'more_sites' %}" class="hover:underline">More Sites</a>
        </div>
        <div class="space-x-2">
          <a href="{% url 'donate' %}" class="hover:underline">Donate</a>
          <span>|</span>
          <a href="{% url 'cart' %}" class="hover:underline">
            Cart {% if request.session.cart %}({{ request.session.cart|length }}){% else %}(0){% endif %}
          </a>
          <span>|</span>

          {% if user.is_authenticated %}
            <a href="{% url 'profile' %}" class="hover:underline">Profile</a>
            {% if request.is_esa_admin %}
            <span>|</span>
            <a href="{% url 'admin_dashboard' %}" class="hover:underline text-red-300">Admin Panel</a>
            {% endif %}
            <span>|</span>
            <a href="{% url 'account_logout' %}" class="hover:underline" id="logout-link">Logout</a>
          {% else %}
            <a href="{% url 'account_login' %}" class="hover:underline">Sign In</a>
            <span>|</span>
            <a href="{% url 'register' %}" class="hover:underline">Create Account</a>
          {% endif %}

        </div>
      </div>
    </div>
    <!-- Main Navigation -->
    <nav class="bg-white shadow">
      <div class="container mx-auto px-4 py-1 flex items-center justify-between">
        <a href="{% url 'home' %}" class="flex items-center">
          <img src="{% static 'images/esa-logo.png' %}" alt="ESA Logo" class="custom-logo " />
        </a>
        <ul class="hidden md:flex space-x-6">
          <li><a href="{% url 'home' %}" class="text-blue-900 hover:text-green-700 font-semibold">Home</a></li>
          <li><a href="{% url 'about' %}" class="text-blue-900 hover:text-green-700 font-semibold">About</a></li>
          <li><a href="{% url 'membership' %}" class="text-blue-900 hover:text-green-700 font-semibold">Membership</a></li>
          <li><a href="{% url 'communities' %}" class="text-blue-900 hover:text-green-700 font-semibold">Communities</a></li>
          <li><a href="{% url 'events' %}" class="text-blue-900 hover:text-green-700 font-semibold">Events</a></li>
          <li><a href="{% url 'store' %}" class="text-blue-900 hover:text-green-700 font-semibold">Store</a></li>
          <li><a href="{% url 'blog' %}" class="text-blue-900 hover:text-green-700 font-semibold">Blog</a></li>
          <li><a href="{% url 'resources' %}" class="text-blue-900 hover:text-green-700 font-semibold">Resources</a></li>
          {% if request.is_esa_admin %}
          <li class="relative group">
            <a href="#" class="text-red-600 hover:text-red-700 font-semibold flex items-center">
              <span>Admin</span>
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </a>
            <div class="absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 hidden group-hover:block">
              <a href="{% url 'admin_dashboard' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Admin Dashboard</a>
              <a href="{% url 'permission_management' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">User Permissions</a>
              {% if request.user_permissions.can_manage_resources %}
              <a href="/admin/core/resource/?is_approved__exact=0" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Pending Resources</a>
              {% endif %}
              {% if request.user_permissions.can_manage_events %}
              <a href="/admin/core/event/" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Manage Events</a>
              {% endif %}
              {% if request.user_permissions.can_manage_store %}
              <a href="/admin/core/product/" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Manage Products</a>
              {% endif %}
              <a href="/admin/" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Django Admin</a>
            </div>
          </li>
          {% endif %}
        </ul>
        <form action="{% url 'search' %}" method="get" class="hidden md:flex items-center space-x-2">
          <input type="text" name="q" placeholder="Search..." class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          <button type="submit" class="text-blue-900 hover:text-green-700">
            <ion-icon name="search" size="large"></ion-icon>
          </button>
        </form>
        {% if not user.is_authenticated %}
          <!-- Remove the JOIN ESA-KU button -->
          <a href="{% url 'register' %}" class="hidden md:inline-block bg-green-700 hover:bg-green-800 text-white px-4 py-2 rounded font-bold">
            JOIN ESA-KU
          </a> 
        {% endif %}
        <!-- Mobile Menu Button -->
        <button class="md:hidden text-blue-900 focus:outline-none">
          <ion-icon name="menu" size="large"></ion-icon>
        </button>
      </div>
    </nav>
  </header>

  <!-- Main Content -->
  <main>
    {% if messages %}
      <div class="container mx-auto px-4 py-4">
        {% for message in messages %}
          <div class="rounded-md p-4 mb-4 {% if message.tags == 'success' %}bg-green-50 text-green-800{% elif message.tags == 'error' %}bg-red-50 text-red-800{% else %}bg-blue-50 text-blue-800{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
    
    {% block content %}
    {% endblock %}
  </main>

  <!-- Footer -->
  <footer class="bg-blue-900 text-white">
    <div class="container mx-auto px-4 py-12">
      <div class="grid md:grid-cols-4 gap-8">
        <!-- Footer Brand -->
        <div>
          <a href="#" class="text-2xl font-bold mb-4 inline-block">ESA-KU</a>
          <p class="text-sm text-gray-300 mt-3">
            Building a vibrant community of engineering minds at Kenyatta University.
          </p>
          <div class="flex space-x-3 mt-4">
            <a href="#" class="p-2 bg-blue-800 rounded hover:bg-blue-700">
              <ion-icon name="logo-facebook" size="small"></ion-icon>
            </a>
            <a href="#" class="p-2 bg-blue-800 rounded hover:bg-blue-700">
              <ion-icon name="logo-twitter" size="small"></ion-icon>
            </a>
            <a href="#" class="p-2 bg-blue-800 rounded hover:bg-blue-700">
              <ion-icon name="logo-linkedin" size="small"></ion-icon>
            </a>
            <a href="#" class="p-2 bg-blue-800 rounded hover:bg-blue-700">
              <ion-icon name="logo-pinterest" size="small"></ion-icon>
            </a>
          </div>
        </div>
        <!-- Explore -->
        <div>
          <h4 class="font-semibold mb-4">Explore</h4>
          <ul class="space-y-2 text-sm">
            <li>
              <a href="{% url 'about' %}" class="hover:underline flex items-center gap-1">
                <ion-icon name="chevron-forward" size="small"></ion-icon>
                About Us
              </a>
            </li>
            <li>
              <a href="{% url 'events' %}" class="hover:underline flex items-center gap-1">
                <ion-icon name="chevron-forward" size="small"></ion-icon>
                Upcoming Events
              </a>
            </li>
            <li>
              <a href="{% url 'blog' %}" class="hover:underline flex items-center gap-1">
                <ion-icon name="chevron-forward" size="small"></ion-icon>
                Blog & News
              </a>
            </li>
            <li>
              <a href="#" class="hover:underline flex items-center gap-1">
                <ion-icon name="chevron-forward" size="small"></ion-icon>
                Privacy Policy
              </a>
            </li>
          </ul>
        </div>
        <!-- Useful Links -->
        <div>
          <h4 class="font-semibold mb-4">Useful Links</h4>
          <ul class="space-y-2 text-sm">
            <li>
              <a href="{% url 'membership' %}" class="hover:underline flex items-center gap-1">
                <ion-icon name="chevron-forward" size="small"></ion-icon>
                Membership Plan
              </a>
            </li>
            <li>
              <a href="#" class="hover:underline flex items-center gap-1">
                <ion-icon name="chevron-forward" size="small"></ion-icon>
                Executive Committee
              </a>
            </li>
            <li>
              <a href="#" class="hover:underline flex items-center gap-1">
                <ion-icon name="chevron-forward" size="small"></ion-icon>
                FAQ
              </a>
            </li>
            <li>
              <a href="#" class="hover:underline flex items-center gap-1">
                <ion-icon name="chevron-forward" size="small"></ion-icon>
                Terms & Conditions
              </a>
            </li>
          </ul>
        </div>
        <!-- Contact Info -->
        <div>
          <h4 class="font-semibold mb-4">Contact Info</h4>
          <ul class="space-y-2 text-sm">
            <li class="flex items-center gap-1">
              <ion-icon name="location-outline" size="small"></ion-icon>
              Kenyatta University, Roysambu, Nairobi
            </li>
            <li class="flex items-center gap-1">
              <ion-icon name="call" size="small"></ion-icon>
              <a href="tel:+25470000002" class="hover:underline">+254 70000002</a>
            </li>
            <li class="flex items-center gap-1">
              <ion-icon name="call" size="small"></ion-icon>
              <a href="tel:+25479999999" class="hover:underline">+254 79999999</a>
            </li>
            <li class="flex items-center gap-1">
              <ion-icon name="mail-outline" size="small"></ion-icon>
              <a href="mailto:contact@esa.com" class="hover:underline">contact@esa.com</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="mt-12 text-center text-sm text-gray-400">
        &copy; 2025 Engineering Students Association-Kenyatta University. All Rights Reserved by 
        <a href="#" class="hover:underline font-semibold">ESA-KU</a>
      </div>
    </div>
  </footer>

  <!-- Authentication JavaScript -->
  <!-- <script>
    // Initialize authentication-related event listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Handle logout link click
      const logoutLink = document.getElementById('logout-link');
      if (logoutLink) {
        logoutLink.addEventListener('click', async function(e) {
          e.preventDefault();
          const result = await auth.logout();
          if (result.status === 'success') {
            window.location.href = '/';
          } else {
            console.error('Logout failed:', result.message);
          }
        });
      }
    });
  </script> -->

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize syntax highlighting for code blocks
      document.querySelectorAll('pre code').forEach((block) => {
        hljs.highlightBlock(block);
      });
    });
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  

</body>
</html>
