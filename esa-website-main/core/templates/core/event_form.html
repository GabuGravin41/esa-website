{% extends "core/base.html" %}
{% load static %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-8">
    <!-- Back button -->
    <div class="mb-4">
        <a href="{% url 'events' %}" class="inline-flex items-center text-[#003366] hover:text-blue-700 transition-colors">
            <i class="fas fa-arrow-left mr-2"></i> Back to Events
        </a>
    </div>
    
    <!-- Form Header -->
    <div class="bg-white rounded-xl shadow-lg p-8">
        <h1 class="text-3xl font-bold text-[#003366] mb-6 border-b pb-2">
            {% if is_create %}Create New Event{% else %}Edit Event: {{ event.title }}{% endif %}
        </h1>
        
        <form method="POST" enctype="multipart/form-data" class="space-y-6">
            {% csrf_token %}
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Title Field -->
                <div class="form-group md:col-span-2">
                    <label for="{{ form.title.id_for_label }}" class="block text-gray-700 font-bold mb-2">Title</label>
                    {{ form.title.errors }}
                    <input type="text" name="{{ form.title.name }}" id="{{ form.title.id_for_label }}" 
                           value="{{ form.title.value|default:'' }}"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent"
                           placeholder="Enter event title">
                </div>
                
                <!-- Category Field -->
                <div class="form-group">
                    <label for="{{ form.category.id_for_label }}" class="block text-gray-700 font-bold mb-2">Category</label>
                    {{ form.category.errors }}
                    <select name="{{ form.category.name }}" id="{{ form.category.id_for_label }}"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent">
                        {% for value, label in form.fields.category.choices %}
                            <option value="{{ value }}" {% if form.category.value == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Status Field -->
                <div class="form-group">
                    <label for="{{ form.status.id_for_label }}" class="block text-gray-700 font-bold mb-2">Status</label>
                    {{ form.status.errors }}
                    <select name="{{ form.status.name }}" id="{{ form.status.id_for_label }}"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent">
                        {% for value, label in form.fields.status.choices %}
                            <option value="{{ value }}" {% if form.status.value == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Date Fields -->
                <div class="form-group">
                    <label for="{{ form.date.id_for_label }}" class="block text-gray-700 font-bold mb-2">Start Date & Time</label>
                    {{ form.date.errors }}
                    <input type="datetime-local" name="{{ form.date.name }}" id="{{ form.date.id_for_label }}" 
                           value="{{ form.date.value|default:'' }}"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent">
                </div>
                
                <div class="form-group">
                    <label for="{{ form.end_date.id_for_label }}" class="block text-gray-700 font-bold mb-2">End Date & Time (Optional)</label>
                    {{ form.end_date.errors }}
                    <input type="datetime-local" name="{{ form.end_date.name }}" id="{{ form.end_date.id_for_label }}" 
                           value="{{ form.end_date.value|default:'' }}"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent">
                </div>
                
                <!-- Location Fields -->
                <div class="form-group">
                    <label for="{{ form.location.id_for_label }}" class="block text-gray-700 font-bold mb-2">Location</label>
                    {{ form.location.errors }}
                    <input type="text" name="{{ form.location.name }}" id="{{ form.location.id_for_label }}" 
                           value="{{ form.location.value|default:'' }}"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent"
                           placeholder="Enter event location">
                </div>
                
                <div class="form-group">
                    <label for="{{ form.venue_type.id_for_label }}" class="block text-gray-700 font-bold mb-2">Venue Type</label>
                    {{ form.venue_type.errors }}
                    <select name="{{ form.venue_type.name }}" id="{{ form.venue_type.id_for_label }}"
                            class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent">
                        {% for value, label in form.fields.venue_type.choices %}
                            <option value="{{ value }}" {% if form.venue_type.value == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Capacity and Price Fields -->
                <div class="form-group">
                    <label for="{{ form.capacity.id_for_label }}" class="block text-gray-700 font-bold mb-2">Capacity</label>
                    {{ form.capacity.errors }}
                    <input type="number" name="{{ form.capacity.name }}" id="{{ form.capacity.id_for_label }}" 
                           value="{{ form.capacity.value|default:'' }}"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent"
                           placeholder="Enter event capacity">
                </div>
                
                <div class="form-group">
                    <label for="{{ form.price.id_for_label }}" class="block text-gray-700 font-bold mb-2">Price (KSH)</label>
                    {{ form.price.errors }}
                    <input type="number" step="0.01" name="{{ form.price.name }}" id="{{ form.price.id_for_label }}" 
                           value="{{ form.price.value|default:'' }}"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent"
                           placeholder="Enter event price">
                </div>
                
                <!-- Speaker Field -->
                <div class="form-group">
                    <label for="{{ form.speaker.id_for_label }}" class="block text-gray-700 font-bold mb-2">Speaker (Optional)</label>
                    {{ form.speaker.errors }}
                    <input type="text" name="{{ form.speaker.name }}" id="{{ form.speaker.id_for_label }}" 
                           value="{{ form.speaker.value|default:'' }}"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent"
                           placeholder="Enter speaker name">
                </div>
                
                <!-- Registration Deadline -->
                <div class="form-group">
                    <label for="{{ form.registration_deadline.id_for_label }}" class="block text-gray-700 font-bold mb-2">Registration Deadline (Optional)</label>
                    {{ form.registration_deadline.errors }}
                    <input type="datetime-local" name="{{ form.registration_deadline.name }}" id="{{ form.registration_deadline.id_for_label }}" 
                           value="{{ form.registration_deadline.value|default:'' }}"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent">
                </div>
                
                <!-- Short Description Field -->
                <div class="form-group md:col-span-2">
                    <label for="{{ form.short_description.id_for_label }}" class="block text-gray-700 font-bold mb-2">Short Description</label>
                    {{ form.short_description.errors }}
                    <textarea name="{{ form.short_description.name }}" id="{{ form.short_description.id_for_label }}" rows="2"
                              class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent"
                              placeholder="Enter a brief description (used in previews)">{{ form.short_description.value|default:'' }}</textarea>
                </div>
                
                <!-- Description Field -->
                <div class="form-group md:col-span-2">
                    <label for="{{ form.description.id_for_label }}" class="block text-gray-700 font-bold mb-2">Full Description</label>
                    {{ form.description.errors }}
                    <textarea name="{{ form.description.name }}" id="{{ form.description.id_for_label }}" rows="6"
                              class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent"
                              placeholder="Enter detailed event description">{{ form.description.value|default:'' }}</textarea>
                </div>
                
                <!-- Image Field -->
                <div class="form-group md:col-span-2">
                    <label for="{{ form.image.id_for_label }}" class="block text-gray-700 font-bold mb-2">Event Image</label>
                    {{ form.image.errors }}
                    
                    {% if event.image %}
                    <div class="mb-3">
                        <p class="text-sm text-gray-600 mb-2">Current image:</p>
                        <img src="{{ event.image.url }}" alt="{{ event.title }}" class="h-32 object-cover rounded">
                    </div>
                    {% endif %}
                    
                    <input type="file" name="{{ form.image.name }}" id="{{ form.image.id_for_label }}"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#003366] focus:border-transparent">
                    <p class="text-xs text-gray-500 mt-1">Optional. Upload an image for the event (recommended size: 1200x600px).</p>
                </div>
                
                <!-- Checkboxes -->
                <div class="form-group">
                    <div class="flex items-center">
                        <input type="checkbox" name="{{ form.featured.name }}" id="{{ form.featured.id_for_label }}"
                               {% if form.featured.value %}checked{% endif %}
                               class="w-4 h-4 text-[#003366] rounded focus:ring-[#003366]">
                        <label for="{{ form.featured.id_for_label }}" class="ml-2 block text-gray-700 font-medium">
                            Feature this event on the homepage
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="flex items-center">
                        <input type="checkbox" name="{{ form.is_active.name }}" id="{{ form.is_active.id_for_label }}"
                               {% if form.is_active.value %}checked{% endif %}
                               class="w-4 h-4 text-[#003366] rounded focus:ring-[#003366]">
                        <label for="{{ form.is_active.id_for_label }}" class="ml-2 block text-gray-700 font-medium">
                            Event is active
                        </label>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">Inactive events won't appear in listings.</p>
                </div>
            </div>
            
            <!-- Form Actions -->
            <div class="flex flex-wrap gap-4 mt-8 pt-4 border-t border-gray-200">
                <button type="submit" class="bg-[#003366] text-white hover:bg-[#00468a] px-6 py-3 rounded-lg transition-colors font-medium">
                    {% if is_create %}Create Event{% else %}Save Changes{% endif %}
                </button>
                <a href="{% url 'events' %}" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-3 rounded-lg transition-colors font-medium">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %} 